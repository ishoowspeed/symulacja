<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Symulator Meczu FIFA Pro</title>
<style>
  body {
    background: radial-gradient(circle at center, #0b3d0b 0%, #012a01 100%);
    color: white;
    font-family: "Poppins", sans-serif;
    text-align: center;
    margin: 0;
  }
  header {
    background: rgba(0,0,0,0.5);
    display: flex;
    justify-content: center;
    gap: 20px;
    padding: 10px;
  }
  header button {
    background: #0a0;
    border: none;
    border-radius: 8px;
    color: white;
    padding: 10px 20px;
    cursor: pointer;
    font-weight: bold;
    transition: 0.3s;
  }
  header button.active, header button:hover {
    background: #00ff00;
    box-shadow: 0 0 10px #00ff00;
  }
  section {
    display: none;
    padding: 20px;
  }
  section.active {
    display: block;
  }
  input, textarea, select, button {
    margin: 5px;
    padding: 8px;
    border-radius: 8px;
    border: none;
    font-size: 1rem;
  }
  textarea {
    width: 90%;
    max-width: 400px;
    height: 100px;
  }
  .team-card {
    background: rgba(0,0,0,0.5);
    border-radius: 10px;
    margin: 10px auto;
    padding: 15px;
    width: 90%;
    max-width: 500px;
  }
  #pitch {
    position: relative;
    width: 600px;
    height: 350px;
    background: linear-gradient(to bottom, #007a00 0%, #005500 100%);
    border: 3px solid white;
    border-radius: 15px;
    margin: 15px auto;
  }
  .player {
    position: absolute;
    width: 70px;
    height: 25px;
    background: rgba(255,255,255,0.2);
    border: 1px solid white;
    border-radius: 5px;
    font-size: 0.7rem;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .out { opacity: 0.4; text-decoration: line-through; }
  .log {
    background: rgba(0,0,0,0.6);
    border-radius: 10px;
    width: 90%;
    max-width: 650px;
    margin: 20px auto;
    padding: 10px;
    height: 220px;
    overflow-y: auto;
    text-align: left;
    font-size: 0.9rem;
  }
</style>
</head>
<body>

<header>
  <button id="tabA" class="active" onclick="showTab('teamA')">Dru≈ºyna A</button>
  <button id="tabB" onclick="showTab('teamB')">Dru≈ºyna B</button>
  <button id="tabMatch" onclick="showTab('match')">Mecz</button>
</header>

<section id="teamA" class="active">
  <div class="team-card">
    <h2>‚öΩ Ustawienia Dru≈ºyny A</h2>
    <input id="teamAName" placeholder="Nazwa klubu A"><br>
    <textarea id="teamAPlayers" placeholder="Podaj zawodnik√≥w (Bramkarz, Obrona, Pomoc, Atak... po przecinku)"></textarea><br>
    <button onclick="saveTeam('A')">Zapisz sk≈Çad</button>
  </div>
</section>

<section id="teamB">
  <div class="team-card">
    <h2>‚öΩ Ustawienia Dru≈ºyny B</h2>
    <input id="teamBName" placeholder="Nazwa klubu B"><br>
    <textarea id="teamBPlayers" placeholder="Podaj zawodnik√≥w (Bramkarz, Obrona, Pomoc, Atak... po przecinku)"></textarea><br>
    <button onclick="saveTeam('B')">Zapisz sk≈Çad</button>
  </div>
</section>

<section id="match">
  <h2>üèüÔ∏è Mecz</h2>
  <select id="stadium">
    <option value="homeA">Stadion Klubu A</option>
    <option value="homeB">Stadion Klubu B</option>
    <option value="neutral">Neutralny stadion</option>
  </select>
  <div id="score">0 : 0</div>
  <div id="time">Czas: 0'</div>
  <button onclick="startMatch()">Start</button>
  <button onclick="pauseMatch()">Pauza</button>
  <button onclick="resetMatch()">Reset</button>
  <div id="pitch"></div>
  <div id="log" class="log"></div>
</section>

<script>
let minute = 0, scoreA = 0, scoreB = 0;
let interval = null, paused = false;
let teamA = [], teamB = [];
let homeAdvantage = 1.0;
let savedTeams = {A:null, B:null};

function showTab(tab){
  document.querySelectorAll("section").forEach(s => s.classList.remove("active"));
  document.querySelectorAll("header button").forEach(b => b.classList.remove("active"));
  document.getElementById(tab).classList.add("active");
  document.getElementById("tab"+tab.charAt(0).toUpperCase()+tab.slice(1)).classList.add("active");
}

function saveTeam(team){
  const name = document.getElementById("team"+team+"Name").value || ("Klub "+team);
  const players = document.getElementById("team"+team+"Players").value.split(",").map(p=>p.trim()).filter(p=>p);
  savedTeams[team] = {name, players};
  alert(`Zapisano sk≈Çad dru≈ºyny ${name}`);
}

function setupPitch(){
  const pitch = document.getElementById("pitch");
  pitch.innerHTML = "";
  teamA = savedTeams.A.players.map(p=>({name:p, team:"A", active:true, pos:detectPos(p)}));
  teamB = savedTeams.B.players.map(p=>({name:p, team:"B", active:true, pos:detectPos(p)}));
  renderPlayers();
}

function detectPos(n){
  n=n.toLowerCase();
  if(n.includes("bram")) return "GK";
  if(n.includes("obron")) return "DEF";
  if(n.includes("pomoc")) return "MID";
  if(n.includes("atak")||n.includes("napad")) return "ATT";
  return "MID";
}

function renderPlayers(){
  const pitch = document.getElementById("pitch");
  pitch.innerHTML="";
  teamA.forEach((p,i)=>{
    const el=document.createElement("div");
    el.className="player "+(p.active?"":"out");
    el.innerText=p.name;
    el.style.left=50+(i%4)*120+"px";
    el.style.top=50+Math.floor(i/4)*60+"px";
    pitch.appendChild(el);
  });
  teamB.forEach((p,i)=>{
    const el=document.createElement("div");
    el.className="player "+(p.active?"":"out");
    el.innerText=p.name;
    el.style.right=50+(i%4)*120+"px";
    el.style.bottom=50+Math.floor(i/4)*60+"px";
    pitch.appendChild(el);
  });
}

function logEvent(t){
  const log=document.getElementById("log");
  log.innerHTML += `<div>[${minute}'] ${t}</div>`;
  log.scrollTop=log.scrollHeight;
}

function randomEvent(){
  const activeA = teamA.filter(p=>p.active);
  const activeB = teamB.filter(p=>p.active);
  const all = [...activeA, ...activeB];
  if(all.length===0) return;
  const player = all[Math.floor(Math.random()*all.length)];
  const base = Math.random();
  let chance = 0;
  if(player.pos==="ATT") chance=0.07;
  else if(player.pos==="MID") chance=0.04;
  else if(player.pos==="DEF") chance=0.015;
  else if(player.pos==="GK") chance=0.005;

  if(player.team==="A") chance *= homeAdvantage;
  if(player.team==="B") chance *= (2-homeAdvantage);

  if(base < chance){
    if(player.team==="A"){ scoreA++; logEvent(`‚öΩ ${player.name} (${savedTeams.A.name}) zdobywa gola!`); }
    else { scoreB++; logEvent(`‚öΩ ${player.name} (${savedTeams.B.name}) zdobywa gola!`); }
  } else if(base < 0.13){
    logEvent(`üü® ≈ª√≥≈Çta kartka dla ${player.name}`);
  } else if(base < 0.14){
    player.active=false;
    logEvent(`üü• ${player.name} otrzymuje czerwonƒÖ kartkƒô i schodzi z boiska!`);
    renderPlayers();
  }
  document.getElementById("score").innerText=`${scoreA} : ${scoreB}`;
}

function startMatch(){
  if(!savedTeams.A || !savedTeams.B){ alert("Najpierw ustaw obie dru≈ºyny!"); return; }
  if(interval) return;
  setupPitch();
  const stadium=document.getElementById("stadium").value;
  homeAdvantage=stadium==="homeA"?1.15:stadium==="homeB"?0.85:1.0;
  logEvent("üîî Mecz rozpoczƒôty!");
  interval=setInterval(()=>{
    if(!paused){
      minute++;
      document.getElementById("time").innerText=`Czas: ${minute}'`;
      randomEvent();
      if(minute>=90){
        clearInterval(interval);
        interval=null;
        logEvent(`üèÅ Koniec meczu! Wynik: ${scoreA} - ${scoreB}`);
      }
    }
  },300);
}

function pauseMatch(){
  paused=!paused;
  logEvent(paused?"‚è∏Ô∏è Pauza":"‚ñ∂Ô∏è Wznowiono mecz");
}

function resetMatch(){
  clearInterval(interval);
  interval=null;
  minute=0;scoreA=0;scoreB=0;paused=false;
  document.getElementById("log").innerHTML="";
  document.getElementById("score").innerText="0 : 0";
  document.getElementById("time").innerText="Czas: 0'";
  setupPitch();
  logEvent("üîÑ Mecz zresetowany.");
}
</script>
</body>
</html>

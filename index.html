<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Symulator Meczu FIFA+</title>
<style>
  body {
    background: radial-gradient(circle at center, #0b3d0b 0%, #012a01 100%);
    color: white;
    font-family: "Poppins", sans-serif;
    text-align: center;
    margin: 0;
    padding: 0;
  }
  h1 { text-shadow: 0 0 10px #0f0; }
  .container {
    display: flex;
    justify-content: center;
    flex-wrap: wrap;
    margin-top: 20px;
  }
  .team-inputs, .match-controls {
    background: rgba(0,0,0,0.5);
    border-radius: 10px;
    margin: 10px;
    padding: 15px;
    width: 280px;
  }
  input, select, button, textarea {
    margin: 4px;
    padding: 6px;
    border-radius: 6px;
    border: none;
    width: 90%;
  }
  button {
    background: #00cc00;
    color: white;
    font-weight: bold;
    cursor: pointer;
  }
  button:hover { background: #00ff00; box-shadow: 0 0 10px #00ff00; }
  #pitch {
    position: relative;
    width: 600px;
    height: 350px;
    background: linear-gradient(to bottom, #007a00 0%, #005500 100%);
    border: 3px solid white;
    border-radius: 15px;
    margin: 15px auto;
  }
  .player {
    position: absolute;
    width: 70px;
    height: 25px;
    background: rgba(255,255,255,0.2);
    border: 1px solid white;
    border-radius: 5px;
    font-size: 0.7rem;
    display: flex;
    justify-content: center;
    align-items: center;
  }
  .out { opacity: 0.4; text-decoration: line-through; }
  .log {
    background: rgba(0,0,0,0.6);
    border-radius: 10px;
    width: 90%;
    max-width: 650px;
    margin: 20px auto;
    padding: 10px;
    height: 220px;
    overflow-y: auto;
    text-align: left;
    font-size: 0.9rem;
  }
</style>
</head>
<body>
<h1>‚öΩ Symulator Meczu FIFA+ ‚öΩ</h1>

<div class="container">
  <div class="team-inputs">
    <h3>Dru≈ºyna A</h3>
    <input id="teamAName" placeholder="Nazwa klubu A" oninput="updateNames()"><br>
    <textarea id="teamAPlayers" rows="6" placeholder="Bramkarz, Obrona, Pomoc, Atak... (po przecinku)"></textarea>
  </div>

  <div class="team-inputs">
    <h3>Dru≈ºyna B</h3>
    <input id="teamBName" placeholder="Nazwa klubu B" oninput="updateNames()"><br>
    <textarea id="teamBPlayers" rows="6" placeholder="Bramkarz, Obrona, Pomoc, Atak... (po przecinku)"></textarea>
  </div>
</div>

<select id="stadium">
  <option value="homeA">Stadion Klubu A</option>
  <option value="homeB">Stadion Klubu B</option>
  <option value="neutral">Neutralny stadion</option>
</select>

<div class="match-controls">
  <h3><span id="nameA">Klub A</span> vs <span id="nameB">Klub B</span></h3>
  <div id="score">0 : 0</div>
  <div id="time">Czas: 0'</div>
  <button onclick="startMatch()">Start</button>
  <button onclick="pauseMatch()">Pauza</button>
  <button onclick="resetMatch()">Reset</button>
</div>

<div id="pitch"></div>
<div id="log" class="log"></div>

<script>
let minute = 0, scoreA = 0, scoreB = 0;
let interval = null, paused = false;
let teamA = [], teamB = [];
let homeAdvantage = 1.0;

function updateNames(){
  document.getElementById("nameA").innerText = document.getElementById("teamAName").value || "Klub A";
  document.getElementById("nameB").innerText = document.getElementById("teamBName").value || "Klub B";
}

function setupPitch(){
  const pitch = document.getElementById("pitch");
  pitch.innerHTML = "";
  const aPlayers = document.getElementById("teamAPlayers").value.split(",").map(p=>p.trim()).filter(p=>p);
  const bPlayers = document.getElementById("teamBPlayers").value.split(",").map(p=>p.trim()).filter(p=>p);
  teamA = aPlayers.map(p=>({name:p, team:"A", active:true, position:detectPos(p)}));
  teamB = bPlayers.map(p=>({name:p, team:"B", active:true, position:detectPos(p)}));
  renderPlayers();
}

function detectPos(name){
  name = name.toLowerCase();
  if(name.includes("bram")) return "GK";
  if(name.includes("obron")) return "DEF";
  if(name.includes("pomoc")) return "MID";
  if(name.includes("atak") || name.includes("napad")) return "ATT";
  return "MID";
}

function renderPlayers(){
  const pitch = document.getElementById("pitch");
  pitch.innerHTML = "";
  teamA.forEach((p,i)=>{
    const el=document.createElement("div");
    el.className="player "+(p.active?"":"out");
    el.innerText=p.name;
    el.style.left = 50 + (i%4)*120 + "px";
    el.style.top = 50 + Math.floor(i/4)*60 + "px";
    pitch.appendChild(el);
  });
  teamB.forEach((p,i)=>{
    const el=document.createElement("div");
    el.className="player "+(p.active?"":"out");
    el.innerText=p.name;
    el.style.right = 50 + (i%4)*120 + "px";
    el.style.bottom = 50 + Math.floor(i/4)*60 + "px";
    pitch.appendChild(el);
  });
}

function logEvent(t){
  const log=document.getElementById("log");
  log.innerHTML += `<div>[${minute}'] ${t}</div>`;
  log.scrollTop = log.scrollHeight;
}

function randomEvent(){
  const allPlayers=[...teamA.filter(p=>p.active),...teamB.filter(p=>p.active)];
  if(allPlayers.length===0) return;
  const player=allPlayers[Math.floor(Math.random()*allPlayers.length)];
  const base=Math.random();

  let chance = 0;
  if(player.position==="ATT") chance=0.07;
  else if(player.position==="MID") chance=0.04;
  else if(player.position==="DEF") chance=0.015;
  else if(player.position==="GK") chance=0.005;

  if(player.team==="A") chance *= homeAdvantage;
  if(player.team==="B") chance *= (2-homeAdvantage);

  if(base < chance){
    if(player.team==="A"){ scoreA++; logEvent(`‚öΩ ${player.name} (${document.getElementById("nameA").innerText}) zdobywa gola!`); }
    else { scoreB++; logEvent(`‚öΩ ${player.name} (${document.getElementById("nameB").innerText}) zdobywa gola!`); }
  } else if(base < 0.13){
    logEvent(`üü® ≈ª√≥≈Çta kartka dla ${player.name}`);
  } else if(base < 0.14){
    player.active=false;
    logEvent(`üü• ${player.name} otrzymuje czerwonƒÖ kartkƒô i opuszcza boisko!`);
    renderPlayers();
  }
  document.getElementById("score").innerText = `${scoreA} : ${scoreB}`;
}

function startMatch(){
  if(interval) return;
  setupPitch();
  const stadium=document.getElementById("stadium").value;
  homeAdvantage = stadium==="homeA" ? 1.15 : stadium==="homeB" ? 0.85 : 1.0;
  logEvent("üîî Mecz rozpoczƒôty!");
  interval=setInterval(()=>{
    if(!paused){
      minute++;
      document.getElementById("time").innerText=`Czas: ${minute}'`;
      randomEvent();
      if(minute>=90){
        clearInterval(interval);
        interval=null;
        logEvent(`üèÅ Koniec meczu! Wynik: ${scoreA} - ${scoreB}`);
      }
    }
  },300);
}

function pauseMatch(){
  paused=!paused;
  logEvent(paused ? "‚è∏Ô∏è Pauza" : "‚ñ∂Ô∏è Wznowiono mecz");
}

function resetMatch(){
  clearInterval(interval);
  interval=null;
  minute=0;scoreA=0;scoreB=0;paused=false;
  document.getElementById("log").innerHTML="";
  document.getElementById("score").innerText="0 : 0";
  document.getElementById("time").innerText="Czas: 0'";
  setupPitch();
  logEvent("üîÑ Mecz zresetowany.");
}
</script>
</body>
</html>

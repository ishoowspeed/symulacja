<!DOCTYPE html>
<html lang="pl">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Symulator meczu FIFA 2D</title>
<style>
  body {
    background: radial-gradient(circle at center, #084, #031);
    color: #fff;
    font-family: "Poppins", sans-serif;
    text-align: center;
    margin: 0;
  }
  header {
    display: flex;
    justify-content: center;
    gap: 20px;
    background: rgba(0,0,0,0.4);
    padding: 10px;
  }
  header button {
    background: #007a00;
    border: none;
    border-radius: 8px;
    color: white;
    padding: 10px 20px;
    cursor: pointer;
    transition: 0.3s;
    font-weight: bold;
  }
  header button.active, header button:hover {
    background: #00cc00;
    box-shadow: 0 0 10px #00ff00;
  }
  section { display: none; padding: 20px; }
  section.active { display: block; }

  input, textarea, select, button {
    margin: 5px;
    padding: 8px;
    border-radius: 8px;
    border: none;
    font-size: 1rem;
  }
  .team-card {
    background: rgba(0,0,0,0.5);
    border-radius: 10px;
    padding: 15px;
    width: 90%;
    max-width: 500px;
    margin: 10px auto;
  }
  #pitch {
    position: relative;
    width: 700px;
    height: 400px;
    margin: 15px auto;
    background: linear-gradient(to bottom, #006600, #004400);
    border: 3px solid white;
    border-radius: 10px;
  }
  .line {
    position: absolute;
    background: white;
  }
  .center-line {
    width: 2px; height: 100%; left: 50%; top: 0;
  }
  .circle {
    width: 80px; height: 80px;
    border: 2px solid white;
    border-radius: 50%;
    position: absolute;
    top: calc(50% - 40px); left: calc(50% - 40px);
  }
  .player {
    position: absolute;
    background: rgba(255,255,255,0.15);
    border: 1px solid white;
    border-radius: 5px;
    width: 80px;
    padding: 2px;
    font-size: 0.7rem;
  }
  .out { opacity: 0.5; text-decoration: line-through; }
  .cards, .goals {
    position: absolute;
    top: 0; font-size: 0.9rem;
  }
  .cards { left: -20px; }
  .goals { right: -20px; }
  #score { font-size: 2rem; margin-top: 10px; }
  #time { margin: 10px; }
  .log {
    background: rgba(0,0,0,0.6);
    border-radius: 10px;
    padding: 10px;
    width: 90%;
    max-width: 650px;
    height: 220px;
    overflow-y: auto;
    margin: 0 auto;
    text-align: left;
    font-size: 0.9rem;
  }
</style>
</head>
<body>

<header>
  <button class="active" onclick="showTab('teamA')">Dru≈ºyna A</button>
  <button onclick="showTab('teamB')">Dru≈ºyna B</button>
  <button onclick="showTab('match')">Mecz</button>
</header>

<section id="teamA" class="active">
  <div class="team-card">
    <h2>Dru≈ºyna A</h2>
    <input id="teamAName" placeholder="Nazwa klubu A"><br>
    Bramkarz: <input id="teamAGK"><br>
    Obrona: <input id="teamADef"><br>
    Pomoc: <input id="teamAMid"><br>
    Atak: <input id="teamAAtt"><br>
    <button onclick="saveTeam('A')">Zapisz sk≈Çad</button>
  </div>
</section>

<section id="teamB">
  <div class="team-card">
    <h2>Dru≈ºyna B</h2>
    <input id="teamBName" placeholder="Nazwa klubu B"><br>
    Bramkarz: <input id="teamBGK"><br>
    Obrona: <input id="teamBDef"><br>
    Pomoc: <input id="teamBMid"><br>
    Atak: <input id="teamBAtt"><br>
    <button onclick="saveTeam('B')">Zapisz sk≈Çad</button>
  </div>
</section>

<section id="match">
  <h2>üèüÔ∏è Mecz</h2>
  <select id="stadium">
    <option value="homeA">Stadion Klubu A</option>
    <option value="homeB">Stadion Klubu B</option>
    <option value="neutral">Neutralny stadion</option>
  </select>
  <div id="score">0 : 0</div>
  <div id="time">Czas: 0'</div>
  <button onclick="startMatch()">Start</button>
  <button onclick="pauseMatch()">Pauza</button>
  <button onclick="resetMatch()">Reset</button>
  <div id="pitch">
    <div class="line center-line"></div>
    <div class="circle"></div>
  </div>
  <div id="log" class="log"></div>
</section>

<script>
let savedTeams = {A:null,B:null}, teamA=[], teamB=[];
let scoreA=0,scoreB=0,minute=0,interval=null,paused=false,homeAdvantage=1.0;

function showTab(tab){
  document.querySelectorAll("section").forEach(s=>s.classList.remove("active"));
  document.querySelectorAll("header button").forEach(b=>b.classList.remove("active"));
  document.getElementById(tab).classList.add("active");
  document.querySelector(`header button[onclick*="${tab}"]`).classList.add("active");
}

function saveTeam(t){
  const name=document.getElementById(`team${t}Name`).value||("Klub "+t);
  const gk=[document.getElementById(`team${t}GK`).value].filter(x=>x);
  const def=document.getElementById(`team${t}Def`).value.split(",").map(x=>x.trim()).filter(x=>x);
  const mid=document.getElementById(`team${t}Mid`).value.split(",").map(x=>x.trim()).filter(x=>x);
  const att=document.getElementById(`team${t}Att`).value.split(",").map(x=>x.trim()).filter(x=>x);
  const all=[...gk,...def,...mid,...att];
  if(all.length>11){ alert("Maksymalnie 11 zawodnik√≥w!"); return; }
  savedTeams[t]={name, gk, def, mid, att};
  alert("Zapisano sk≈Çad: "+name);
}

function setupPitch(){
  const pitch=document.getElementById("pitch");
  pitch.innerHTML='<div class="line center-line"></div><div class="circle"></div>';
  teamA=[]; teamB=[];
  buildTeam(savedTeams.A, teamA, true);
  buildTeam(savedTeams.B, teamB, false);
  renderPlayers();
}
function buildTeam(tObj, arr, left){
  const {gk,def,mid,att}=tObj;
  const add=(name,pos)=>{
    arr.push({name,pos,team:left?"A":"B",yellow:0,red:false,goals:0,active:true});
  }
  gk.forEach(p=>add(p,"GK"));
  def.forEach(p=>add(p,"DEF"));
  mid.forEach(p=>add(p,"MID"));
  att.forEach(p=>add(p,"ATT"));
}

function renderPlayers(){
  const pitch=document.getElementById("pitch");
  function draw(team, left){
    const layerY={"GK":330,"DEF":240,"MID":150,"ATT":60};
    const startX=left?80:620;
    const dir=left?1:-1;
    let i=0;
    team.forEach(p=>{
      const el=document.createElement("div");
      el.className="player "+(p.active?"":"out");
      el.style.top=layerY[p.pos]+"px";
      el.style[left?"left":"right"]=(startX+(i%4)*dir*90)+"px";
      el.innerText=p.name;
      const cards=document.createElement("div");
      cards.className="cards";
      cards.innerText=p.red?"üü•":"üü®".repeat(p.yellow);
      const goals=document.createElement("div");
      goals.className="goals";
      goals.innerText="‚öΩ".repeat(p.goals);
      el.appendChild(cards);
      el.appendChild(goals);
      pitch.appendChild(el);
      i++;
    });
  }
  draw(teamA,true);
  draw(teamB,false);
}

function logEvent(t){
  const log=document.getElementById("log");
  log.innerHTML+=`<div>[${minute}'] ${t}</div>`;
  log.scrollTop=log.scrollHeight;
}

function randomEvent(){
  const all=[...teamA.filter(p=>p.active),...teamB.filter(p=>p.active)];
  if(all.length===0)return;
  const p=all[Math.floor(Math.random()*all.length)];
  const r=Math.random();
  if(r<0.04){ // akcja nieudana
    const akcje=["≈õwietne podanie, ale strza≈Ç niecelny",
      "drybling i... tu≈º obok!",
      "uderzenie z dystansu, minimalnie obok!",
      "pr√≥ba przewrotki, ale nie trafia czysto!",
      "piƒôkne podanie, ale bramkarz ≈Çapie!",
      "gro≈∫na sytuacja, strza≈Ç zablokowany!"];
    logEvent(`${p.name} (${p.team}) ${akcje[Math.floor(Math.random()*akcje.length)]}`);
  } else if(r<0.09){ // gol
    const typy=["uderzenie z dystansu!","g≈Ç√≥wka!","przewrotka!","piƒôkna akcja zespo≈Çowa!","mocny strza≈Ç pod poprzeczkƒô!"];
    logEvent(`‚öΩ ${p.name} (${p.team}) ${typy[Math.floor(Math.random()*typy.length)]}`);
    p.goals++;
    if(p.team==="A")scoreA++; else scoreB++;
  } else if(r<0.12){ // ≈º√≥≈Çta kartka rzadziej
    if(p.red||!p.active)return;
    p.yellow++;
    if(p.yellow>=2){ p.red=true; p.active=false; logEvent(`üü• ${p.name} (druga ≈º√≥≈Çta - wylatuje!)`); }
    else logEvent(`üü® ${p.name} otrzymuje ≈º√≥≈ÇtƒÖ kartkƒô`);
  }
  document.getElementById("score").innerText=`${scoreA} : ${scoreB}`;
  renderPlayers();
}

function startMatch(){
  if(!savedTeams.A||!savedTeams.B){ alert("Ustaw obie dru≈ºyny!"); return; }
  if(interval)return;
  setupPitch();
  const stadium=document.getElementById("stadium").value;
  homeAdvantage=stadium==="homeA"?1.1:stadium==="homeB"?0.9:1.0;
  logEvent("üîî Mecz rozpoczƒôty!");
  interval=setInterval(()=>{
    if(!paused){
      minute++;
      document.getElementById("time").innerText=`Czas: ${minute}'`;
      randomEvent();
      if(minute>=90){
        clearInterval(interval);
        interval=null;
        logEvent(`üèÅ Koniec meczu! Wynik: ${scoreA} - ${scoreB}`);
      }
    }
  },300);
}
function pauseMatch(){ paused=!paused; logEvent(paused?"‚è∏Ô∏è Pauza":"‚ñ∂Ô∏è Wznowiono mecz"); }
function resetMatch(){
  clearInterval(interval);interval=null;minute=0;scoreA=0;scoreB=0;paused=false;
  document.getElementById("score").innerText="0 : 0";
  document.getElementById("time").innerText="Czas: 0'";
  document.getElementById("log").innerHTML="";
  document.getElementById("pitch").innerHTML='<div class="line center-line"></div><div class="circle"></div>';
}
</script>
</body>
</html>
